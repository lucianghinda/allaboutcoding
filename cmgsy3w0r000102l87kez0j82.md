---
title: "How to Use Pattern Matching to Locate Elements in a Hash Array"
seoTitle: "Locating Elements in Hash Arrays Using Pattern Matching in Ruby"
seoDescription: "Learn how to effectively use Ruby's pattern matching to locate elements within a hash array and handle exceptions"
datePublished: Thu Oct 16 2025 04:54:28 GMT+0000 (Coordinated Universal Time)
cuid: cmgsy3w0r000102l87kez0j82
slug: how-to-use-pattern-matching-to-locate-elements-in-a-hash-array
cover: https://cdn.hashnode.com/res/hashnode/image/upload/v1760590403754/f53e8f0b-02b1-4df7-8c23-bba12a4d9c0f.png
ogImage: https://cdn.hashnode.com/res/hashnode/image/upload/v1760590426076/a521bf25-8dcd-4d80-9f83-dab26572f9a9.png
tags: ruby, patterns, ruby-on-rails, pattern-matching, matching

---

Having the following structure of a Hash that includes an Array of Hashes, for example, and you want the email of a moderator:

```ruby
system = {
  users: [
    { username: 'alice', role: 'admin', email: 'alice@example.com' },
    { username: 'bob', role: 'user', email: 'bob@example.com' },
    { username: 'charlie', role: 'moderator', email: 'charlie@example.com' }
  ]
}

moderator = system[:users].find { |u| u[:role] == 'moderator' }
email = moderator[:email] 

puts email # charlie@example.com
```

Now here is doing the same thing in Ruby using pattern matching:

```ruby
system = {
  users: [
    { username: 'alice', role: 'admin', email: 'alice@example.com' },
    { username: 'bob', role: 'user', email: 'bob@example.com' },
    { username: 'charlie', role: 'moderator', email: 'charlie@example.com' }
  ]
}

system => {users: [*, { role: 'moderator', email: }, *]}
puts email # charlie@example.com
```

Letâ€™s put the two lines one above the other:

```ruby
# Using Enumerator#find
moderator = system[:users].find { |u| u[:role] == 'moderator' }
email = moderator[:email] 

# Using Pattern Matching
system => {users: [*, { role: 'moderator', email: }, *]}
```

There is another difference between them: in case of Pattern Matching it will throw a `NoMatchingPatternError` when not found, while the two lines that use `Enumerator#find` will throw a `NoMethodError`:

```ruby
moderator = system[:users].find { |u| u[:role] == 'THIS_ROLE_DOES_NOT_EXISTS' }
email = moderator[:email] 
# undefined method '[]' for nil (NoMethodError)

system => {users: [*, { role: 'THIS_ROLE_DOES_NOT_EXISTS', email: }, *]}
# {users: [{username: "alice", role: "admin", email: "alice@example.com"}, 
# {username: "bob", role: "user", email: "bob@example.com"}, 
# {username: "charlie", role: "moderator", email: "charlie@example.com"}]}: 
# [{username: "alice", role: "admin", email: "alice@example.com"}, 
# {username: "bob", role: "user", email: "bob@example.com"}, 
# {username: "charlie", role: "moderator", email: "charlie@example.com"}] 
# does not match to find pattern (NoMatchingPatternError)does not match 
# to find pattern (NoMatchingPatternError)
```

## How does pattern matching work in this example

If `email` does *not exist* either as a variable or method, matching it will create a local variable with the value from the matched row's key.

```ruby
system = {
  users: [
    { username: 'charlie', role: 'moderator', email: 'charlie@example.com' }
  ]
}
system => {users: [*, { role: 'moderator', email: }, *]}
# => [:system, :email, :_]
```

If a variable of method labeled `email` does exists, it will just try to match it against its value:

```ruby
system = {
  users: [
    { username: 'charlie', role: 'moderator', email: 'charlie@example.com' }
  ]
}

email = 'charlie@example.com'
system => {users: [*, { role: 'moderator', email: }, *]}
puts email # charlie@example.com
```

Of course if that variable will contain something that cannot be found while matching, it will throw an exception:

```ruby
system = {
  users: [
    { username: 'charlie', role: 'moderator', email: 'charlie@example.com' }
  ]
}
email = 'bob@example.com'
system => {users: [*, { role: 'moderator', email: }, *]}
# (NoMatchingPatternError)
```